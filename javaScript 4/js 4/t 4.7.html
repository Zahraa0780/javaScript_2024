<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Route to Karaportti 2</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>
</head>
<body>
    <h1>Find Route to Karaportti 2</h1>
    <form id="routeForm">
        <input id="address" name="address" type="text" placeholder="Enter your address" required>
        <button type="submit">Find Route</button>
    </form>

    <div id="map" style="height: 500px;"></div>
    <p id="routeInfo"></p>

    <script>
        // Initialize the map
        const map = L.map('map').setView([60.200, 24.930], 13);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        document.getElementById('routeForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const address = document.getElementById('address').value;

            // Geocode the address
            fetch(`https://api.digitransit.fi/geocoding/v1/search?q=${encodeURIComponent(address)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.features.length > 0) {
                        const startCoordinates = data.features[0].geometry.coordinates;
                        const endCoordinates = [60.200, 24.930]; // Karaportti 2 coordinates

                        // Add routing control to the map
                        L.Routing.control({
                            waypoints: [
                                L.latLng(startCoordinates[1], startCoordinates[0]),
                                L.latLng(endCoordinates[1], endCoordinates[0])
                            ],
                            routeWhileDragging: true,
                            showAlternatives: false,
                            createMarker: function() { return null; }
                        }).addTo(map);

                        // Display route information
                        document.getElementById('routeInfo').textContent = `Start: ${new Date().toLocaleTimeString()} - End: ${new Date(new Date().getTime() + 3600000).toLocaleTimeString()}`;
                    } else {
                        alert('Address not found in Helsinki.');
                    }
                })
                .catch(error => {
                    console.error('Error fetching route:', error);
                });
        });
    </script>
</body>
</html>
